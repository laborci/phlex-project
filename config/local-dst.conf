
<Directory /htdocs/PhlexSite/var/files/>
	<Files *>
		AllowOverride None
		SetHandler default-handler
	</Files>
</Directory>


<VirtualHost *:80>

    # answer any related subdomain
	ServerName phlex.dev
	ServerAlias *.phlex.dev

	# the public folder - It contains the image, js, css assets, the favicon and the router itself
	DocumentRoot "/htdocs/PhlexSite/public/"

#	Options -Indexes
#	AllowOverride None

	php_flag session.cookie_httponly on
	ErrorLog /htdocs/PhlexSite/var/log/apache_error.log
	Alias /files/ /htdocs/PhlexSite/var/files/
	Alias /thumbnails/ /htdocs/PhlexSite/var/thumbnails/

	php_flag log_errors on
	php_flag display_errors off
	php_value error_reporting 2147483647
	php_value error_log /htdocs/PhlexSite/var/log/php_error.log

	RewriteEngine on
	UseCanonicalName on

	Options +Indexes
	Options +FollowSymlinks


# deny access to the assets folder itself
	RewriteRule ^/assets/(.*)?$ [R=404,L]

# --- thumbnail generator ---
    RewriteCond %{REQUEST_URI} ^/thumbnails/(.+)
    RewriteCond /htdocs/PhlexSite/var/%{REQUEST_URI} !-f
    RewriteRule ^(.*)$ /index.php [L]
# --- index.php ---
	RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-F
	RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-d
	RewriteCond %{REQUEST_URI} !^/?(\!?(thumbnails|files|img|css|js|plugin))/?(.*)
	RewriteRule ^(.*)$ /index.php [L]

</VirtualHost>
